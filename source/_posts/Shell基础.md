---
title: Shell基础
date: 2018-10-11 17:34:47
tags: 课程学习
categories: Linux
---

# Shell基础

在Linux系统中，Shell是最常使用的程序，其主要作用是侦听用户指令、启动指令所指定的进程并将结果返回给用户。这里主要讲述Shell的基本使用方法。  

## Shell起步

在AT&T工作的Dennis Ritchie和Ken Thompson两人设计的Unix的时候，他们想要为用户创建一种与他们的新系统交流的方法。那时的操作系统带有命令解释器。命令解释器接受用户的命令，然后解释它们，因而计算机可以使用这些命令。  
当登入系统或打开一个终端窗口时，首先看到的是Shell提示符。要运行命令的话，只需要在提示符后敲进命令，然后再按“回车”键。  
一个Shell命令可能含有一些可选项和参数，其一般格式为：  
[Shell命令][可选项][参数]  
Linux系统由以下4个重要的部分组成：
1. 内核
2. Shell
3. 文件系统
4. 应用程序
内核部分，操作者不易和它直接沟通，因此，必须要有一个友善的界面，使得操作时能更为方便，这个界面便是Shell。通俗地讲，Shell就是位于核心和操作者之间的一层使用者界面。  
Shell的本意是“壳”的意思。在核心的外面，包覆着一层外壳，用来负责接收使用者输入的指令，然后将指令解译成核心能够了解的方式，传给核心去执行，再将结果传回至预设的输出周边设备。  

### Shell类型和功能

Linux系统中的Shell，除了可作为命令编译器之外，它也是一种不错的编程语言，是系统管理维护时的重要工具。  
由于Linux系统对Shell的处理，采用独立自由开放的方式，因此，Shell的种类相当多，目前流行的Shell有sh，csh，ksh，tcsh和bash等。  
在Linux系统中的bash具有以下功能：  
（1）兼容Bourne Shell（sh）；
（2）包含C Shell以及Korn Shell中最好的功能；
（3）具有命令列编写修改的能力；
（4）具有工作控制的能力，可控制前台和后台程序；
（5）具有Shell编程能力。

## 开始使用bash

当用户登录到Linux系统后，一旦出现提示符号时，便可以开始输入操作命令了。命令可分为如下两大类：  
（1）bash内置的命令；
（2）应用程序。

### 通配符

bash中使用的通配符  

|符号|含义|
|:---|:---|
|?|代表任何单一字符|
|*|代表任何字符|
|[字符组合]|在中括号中的字符皆符合，如：[a~z]代表所有的小写字母|
|[!字符组合]|不再中括号中的字符皆符合，如：[!0~9]代表非数字的皆符合|

### 特殊字符及引号

特殊字符及引号  

|符号|意义|符号|意义|
|:----|:----|:----|:----|
|~|用户主目录|\||管道|
|`|命令取代|?|通配符，代表任何单一字符|
|#|解释|<|输入重定向|
|$|变量取值|>|输出重定向|
|&|后台进程工作|'|单引号（不具有变数置换的功能）|
|*|通配符，代表任何字符|"|双引号（具有变数置换的功能）|
|\(|子Shell开始|/|路径分隔符|
|\)|子Shell结束|;|命令分隔符|
|\\|使命令持续到下一行|

### 常用控制组合键

常用控制组合键  

|组合键|意义|
|:----|:----|
|Ctrl+C|终止目前的命令|
|Ctrl+\|终止目前的命令|
|Ctrl+D|输入结束，即EOF之意（如使用mail信件结束时），或注销Linux|
|Ctrl+Z|暂停目前的命令|
|Ctrl+M|相当于按“Enter”键|
|Ctrl+S|暂停屏幕输出|
|Ctrl+Q|恢复屏幕输出|
|Ctrl+U|将命令列整列删除|

## Shell实用功能

Linux系统是在命令行下面诞生的，因此，Linux中的命令行有许多非常实用的功能。  

### 命令行自动补全

在Linux系统中有太多的命令和配置文件，可以使用命令补全功能快速地写出文件名和命令名称。  
例如，如果需要快速地从当前所在的目录跳转到/usr/src/redhat/目录，可以执行#cd /u\<Tab>/sr\<Tab>/r\<Tab>  
\<Tab>是按“Tab”键的意思，使用“Tab”键也称为“命令行自动补全”，这在平常应用中是不可缺少的。

### 命令历史纪录

通过按向上方向键，可以向后遍历最近在该控制台下输入的命令。用向下方向键可以向前遍历命令。与“shift”键连用的话，还可以遍历以往在该控制台中的输出。也可以编辑旧的命令，然后再运行。  

#### 编辑命令行

通过光标和功能键（Home，End等键），可以浏览并编辑命令行，还可以用键盘的快捷方式来完成一般的编辑，主要功能键如下。  
[Ctrl+k]：删除从光标到行尾的部分。
[Ctrl+u]：删除从光标到行首的部分。
[Alt+d]：删除从光标到当前单词结尾的部分。
[Ctrl+w]：删除从光标到当前单词开头的部分。
[Ctrl+a]：将光标移到行首。
[Ctrl+e]：将光标移到行尾。
[Alt+a]：将光标移到当前单词头部。
[Alt+e]：将光标移到当前单词尾部。
[Ctrl+y]：插入最近删除的单词。
[!$]：重复前一个命令最后的参数。

> 使用命令行记录功能键：  
//创建目录/root/aaa  
mkdir /root/aaa  
//重复前一个命令最后的参数，参数是/root/aaa  
cd !$  
cd /root/aaa   
//显示用户当前目录是/root/aaa   
pwd  

#### 可用的Shell快捷方式

Linux系统带有不少快捷方式，其中一部分是bash原来就有的，还有一些则是预先设置的。由于主目录是每位用户的活动中心，许多Linux系统对此有特殊的快捷方式。  
“~”就是用户的主目录的简写形式。

### 命令行的排列、替换和别名

在Shell中可以使用命令排列同时执行多个命令，可以使用命令替换将一个命令的输出当作另一个命令的输入，也可以将复杂命令定义别名。  

#### 命令的排列

如果希望一次执行多个命令，Shell允许在不同的命令之间，放上特殊的排列字符。这里将介绍最常用的两种方法。  

（1）使用“;”  
使用“;”命令时先执行命令1，不管命令1是否出错，接下来就执行命令2。  
命令语法：  
命令1;命令2
（2）使用“&&”  
使用“&&”命令时只有当命令1正确运行完毕后，才能执行命令2。
命令语法：  
命令1&&命令2  

> 使用排列命令“;”同时执行两个命令：  
//现在屏幕上列出/boot目录中的所有内容，然后列出目录/root及其子目录所占磁盘大小  
ls -l /boot;du -hs /root  
使用排列命令“&&”同时执行两个命令：  
//将返回“ls：无法访问/root/bogusdir：没有那个文件或目录”，而“du -hs”命令根本没有运行，因为没有/root/bogusdir目录  
ls -a /root/bogusdir&&du -hs  


#### 命令替换

命令替换这种机制的语法如下。  
命令1$(命令2)  
除了使用“$()”之外，还可以使用后引号“\`”,命令语法如下所示。  
命令1 \`命令2\`

> //查看less进程号，假如为4163：  
Pidof less  
Kill -9 4163  
//可以写为：  
kill -9 $(pidof less)  
kill -9 \`pidof less\`

#### 命令别名

在需要执行某一非常长的命令时，所有的命令以及命令的选项、参数都要一一输入，很枯燥也容易出现错误。可以为常用命令定义快捷方式，这些快捷方式可以用较简单的命令别名来定义。  
命令语法：  
alias [别名]=[需要定义别名的命令]

### 文件名匹配和输出重定向

#### 文件名匹配

文件名匹配使得用户不必一一写出文件名称就可以指定多个文件。  
“*”可匹配一个或多个字符。  
第二个通配符是问号“?”。在匹配时，一个问号只能代表一个字符。  

#### 管道

Linux系统的理念是汇集许多小程序，每个程序都有特殊的专场。复杂的任务不是由大型软件完成，而是运用Shell的机制，组合许多小程序共同完成。管道就是其中发挥着重要的作用，它可以将某个命令的输出信息当作某个命令的输入，由管道符号“\|”来标识。  
命令语法：  
[命令1]|[命令2]|[命令3]

> //命令ls /etc显示/etc目录的内容，命令more是分页显示内容  
ls /etc|more  
//命令rpm -qa显示已经安装在系统上RPM包，命令grep a是过滤软件包，命令more是分页显示这些信息  
rpm -qa|grep a|more  


#### 重定向文件

有时，希望将命令的输出结果保存到文件中，或以文件内容作为命令的参数，这时就需要用到重定向，重定向不使用系统的标准输入端口、标准输出端口或标准错误端口，而进行重新的制定。重定向有5种方式，分别是：输出重定向、输入重定向、错误重定向、追加重定向以及同时实现输出和错误的重定向。  
（1）输出重定向  
输出重定向，即将command命令的输出保存到文件file中，如果存在相同的文件，则覆盖file文件中的内容。  
命令语法：  
command \> file  

> //使用输出重定向将目录/boot的内容保存到文件/root/abc：  
ls /boot > /root/abc  
//使用echo命令和输出重定向创建文本文件/root/mm，内容是hello。  
echo hello > /root/mm  

（2）输入重定向  
输入重定向，即将文件file的内容作为command命令的输入。  
命令语法：  
command \< file  

> //使用输入重定向将文件/root/mm的内容作为输入让cat命令执行  
cat < /root/mm  

（3）错误重定向  
错误重定向，即将command命令执行的出错信息输出到文件file中。  
命令语法：  
command 2 \> file  
（4）追加重定向
追加重定向，即将command命令执行的输出添加到已存在的文件file中。  
命令语法：  
command \>\> file  
（5）同时实现输出和错误的重定向  
同时实现输出和错误的重定向，即可以同时实现输出重定向和错误重定向的功能。  
命令语法：  
command &\> file  